fn length_of_lis(nums: &[i32]) -> i32 {
    let mut dp: Vec<i32> = vec![];

    for &num in nums {
        if let Err(j) = dp.binary_search(&num) {
            if j == dp.len() {
                dp.push(num);
            } else {
                dp[j] = num;
            }
        }
    }

    dp.len() as i32
}

impl Solution {
    #[must_use]
    #[allow(clippy::needless_pass_by_value)]
    pub fn length_of_lis(nums: Vec<i32>) -> i32 {
        length_of_lis(&nums)
    }
}

pub struct Solution;

#[cfg(test)]
mod tests {
    use crate::problem_0300::length_of_lis;

    #[test]
    fn test_1() {
        assert_eq!(length_of_lis(&[10, 9, 2, 5, 3, 7, 101, 18]), 4);
    }

    #[test]
    fn test_2() {
        assert_eq!(length_of_lis(&[0, 1, 0, 3, 2, 3]), 4);
    }

    #[test]
    fn test_3() {
        assert_eq!(length_of_lis(&[7, 7, 7, 7, 7, 7, 7]), 1);
    }

    #[test]
    fn test_4() {
        assert_eq!(length_of_lis(&[4, 1, 2, 3, 0]), 3);
    }

    #[test]
    fn test_5() {
        assert_eq!(length_of_lis(&[4, 10, 4, 3, 8, 9]), 3);
    }

    #[test]
    fn test_6() {
        assert_eq!(length_of_lis(&[1, 2, 3, 0]), 3);
    }

    #[test]
    fn test_7() {
        assert_eq!(length_of_lis(&[6, 1, 2, 3]), 3);
    }

    #[test]
    fn test_8() {
        assert_eq!(length_of_lis(&[1, 3, 6, 7, 9, 4, 10, 5, 6]), 6);
    }

    #[test]
    fn test_9() {
        assert_eq!(
            length_of_lis(&[
                -932, 187, 528, 943, -339, -847, -671, 175, 105, -338, 858, 13, 627, -102, -924,
                -882, -515, 991, 75, -80, 658, -764, -460, 579, 12, -53, -977, 346, 882, 420, -946,
                983, -908, -987, -104, 934, 123, -863, 393, 809, 783, 111, -253, -254, 273, -436,
                -223, -809, -123, 907, -882, 849, -700, -960, -976, -264, 58, -136, 107, -682,
                -696, 65, 834, -62, 125, -111, -513, -509, -799, 969, 724, 651, 410, -486, -428,
                -328, 665, -336, -567, 531, 16, -849, -241, 484, 186, -856, 896, 295, 113, 267,
                -522, -570, -767, 720, 968, -175, 743, -861, -247, 133, -190, 22, 538, -382, -457,
                -3, -757, -235, -829, -792, -168, -647, 328, -282, -749, 635, 537, 561, -906, 141,
                -581, -52, 409, 477, -232, 831, -670, 198, 200, 995, -903, -168, 233, 946, 812,
                390, 550, 776, -185, 879, -140, -290, -572, -648, -69, -297, 836, 704, -314, -884,
                -375, -402, -526, 469, 692, -491, -533, -212, -390, 539, 645, 24, -48, 721, 748,
                -774, 78, 578, -481, 471, -757, -505, 734, 853, -339, 516, -894, -314, 254, 445,
                -286, -652, -480, -12, -978, -816, 310, -941, -347, 262, 659, -480, -807, 378, 501,
                -67, 39, -113, -349, -98, -500, -744, 835, -559, 965, -41, -217, 326, -571, -724,
                -38, 372, 413, 591, 936, 391, -993, -863, 452, 513, 955, 478, -488, 342, -605,
                -661, -939, 363, -781, 527, -254, -566, -682, 380, -940, -840, -770, 664, -49, 851,
                -290, -399, 927, -121, 840, 841, 750, -332, 198, -894, -650, -51, 739, 969, -840,
                -70, 402, 741, -807, 293, -323, -310, -387, 644, -734, -21, -499, -863, 921, -58,
                -883, 343, -213, 770, -797, -1000, -613, -293, -362, -259, -19, -303, -474, 897,
                -422, 602, 652, 636, 336, 531, -477, 389, -780, 790, -347, 876, 47, 6, 250, -796,
                527, 946, 111, 515, 845, -408, -579, 854, 873, -494, 373, -117, -198, 110, 702,
                759, -962, 298, -988, -397, -926, -472, -268, -104, -245, -5, 551, -728, 143, 678,
                639, 316, 406, -473, 174, 445, 326, 615, 717, 978, 87, -449, -968, 33, -349, -831,
                709, -962, -260, -737, 369, -557, 215, 383, 870, -314, -323, -692, -855, -234, 857,
                -331, 645, 700, -850, 918, -12, -236, 237, 390, 39, 170, 920, -737, -760, 426, 193,
                -186, 858, -600, 490, 405, -43, 948, 862, 532, 417, 457, -759, 479, -948, -582,
                -688, -177, -901, 391, 287, -829, -540, 266, -448, 50, 451, 187, 55, -896, -664,
                394, -226, 300, -447, 814, -197, -681, -840, 410, -590, 52, 562, 844, -717, 0, 818,
                -967, 195, 875, 462, -777, 356, 91, 575, -524, -613, 328, -255, -57, 963, 677, -18,
                540, 2, 622, -797, -704, 426, -407, 806, -476, 440, 90, -472, 103, -746, -205, 803,
                604, 836, -22, 487, -424, 164, -54, -267, -430, -976, 852, 908, 824, -370, -638,
                209, -532, 45, -453, -164, 272, 721, 858, -812, 989, -726, 476, 33, 544, -519,
                -191, 841, -239, -182, -36, -295, 940, 384, -221, -537, -642, 94, 826, -339, -197,
                680, -943, 232, -762, 968, -18, 792, -159, 60, -230, 609, 349, -621, 840, -570,
                311, -565, -690, -462, 844, -355, -903, -287, -262, -7, -526, 13, 654, -417, -297,
                -906, -291, 601, 183, 139, 577, 335, -780, -941, -863, -452, 128, 856, -193, -106,
                893, 747, -633, 796, 130, -325, -94, -85, -458, -712, -739, -255, 851, -866, -731,
                -547, 41, 619, 941, 119, 329, 505, 668, 433, -831, -942, 122, -379, -692, -136,
                286, -492, -58, 908, 719, 753, -271, 31, 564, 451, 814, 622, -907, 707, 270, -791,
                -970, -958, -807, -297, -582, 479, -881, -874, 140, -534, 617, 557, -938, -50, 15,
                -295, 932, -523, 468, -757, -986, 525, 966, 597, 698, -829, 342, 571, 353, 49, 235,
                883, 636, 201, 722, 823, 341, 911, 93, -114, 449, -700, -267, 16, 854, -68, 89,
                844, 368, -900, -840, -957, -928, -597, 296, 225, 18, -635, -935, -929, 35, -579,
                256, -204, -177, -552, -591, 730, -691, 850, 597, -739, -554, 811, -198, 216, 761,
                -263, -425, 581, -490, 765, 614, 791, -139, -315, -552, 170, -474, 311, -365, 300,
                711, 633, 151, -646, 899, 588, 175, -230, 413, 403, -805, -58, 414, -648, -199,
                -462, -247, 401, 758, -954, 360, 983, 449, 596, 684, 716, -716, -656, 437, -396,
                -907, 530, -712, -284, -960, 190, -602, 855, -156, -839, 616, 875, 645, 226, 651,
                -317, 717, 891, 560, -64, 181, 431, 640, 718, -178, -261, -846, -37, 641, -934,
                -200, 846, 371, -922, 616, 540, 893, -835, 584, 148, -91, -348, -485, -691, 366,
                -997, -578, -24, 860, 647, 61, 521, 996, -103, -254, 12, 323, -808, 983, 365, -751,
                -222, -509, 325, -178, -116, -753, -949, 745, 300, -513, -288, 690, 871, 34, 756,
                -759, -408, -383, -223, 231, 349, -690, 94, -672, 574, 262, 224, 523, 284, -121,
                -923, -175, 152, -788, -675, 175, 798, 568, -625, -328, -898, -408, -679, 588,
                -686, 971, -250, -405, 331, 752, -290, -421, -667, 940, -19, 240, 646, -962, 614,
                -28, 140, 608, 376, -255, 630, -757, 161, -50, -243, 718, -725, -277, -900, -194,
                676, -908, 917, 935, 846, 513, -86, -466, -900, -23, -237, -673, -482, 408, -138,
                726, -250, 174, -997, 581, -594, 628, -840, 454, -601, 87, 308, 262, -847, -909,
                -147, 536, -889, 567, -436, 749, -575, 699, 563, -362, 39, 950, -618, 917, 87, 252,
                -526, 689, -870, -547, -851, -513, -475, 787, -498, -743, -414, -423, 774, -400,
                856, 271, -88, 573, -989, 475, -974, -293, -620, 42, 33, -276, -690, -858, 746,
                -305, -809, 506, -25, 632, -855, -809, 880, -188, 345, 140, 164, -381, -158, 284,
                668, 829, 500, 140, 8, 409, 718, 193, -797, -942, -385, -665, 667, -510, 370, 754,
                -71, -6, -867, -341, -744, -353, 286, 37, 217, 806, -27, 921, -17, -738, -803, 644,
                -611, 784, -236, -570, -898, -476, -676, 967, -542, -380, -944, 336, -744, 155,
                -965, 653, -467, 294, -639, -834, 817, -473, -333, 581, 92, 50, 388, 683, -496,
                -292, 70, -668, -127, 705, -307, -762, 691, 99, 220, 809, 405, -311, 627, -46, 732,
                415, 379, 96, -53, 264, 563, -850, 958, -369, -646, 404, 635, 367, -169, -200, 292,
                -226, -788, 53, -490, -166, -292, 897, -151, 696, 101, 849, -577, 249, 264, -475,
                321, 161, -354, -894, -248, -1, 805, 295, -207, -24, 821, -181, -660, 140, 686,
                837, -833, -273, -620, -150, -606, 78, 55, -997, -596, -617, -464, -874, -743,
                -246, -270, 123, 788, 198, -360, -479, 753, 482, 95, -66, -427, 759, 205, 925, 656,
                -866, -981, -534, 604, 551, -193, -779, -383, 255, 977, -19, 538, -534, -582, -334,
                121, 28, 884, -412, 882, 929, 160, -825, -8, 958, 436, -435, -874, 979, 141, 443,
                602, 171, -930, 108, -215, 346, 425, -446, -54, 968, -380, 566, 893, 109, -335,
                762, -420, -51, 568, 38, 109, 391, -589, -244, 348, -262, -759, -900, 23, -105,
                802, 503, -219, 861, 337, -6, 549, -477, 665, -290, 160, -271, 161, 246, -625,
                -456, 158, -189, -570, 898, 14, 801, 362, 156, 691, 619, -944, -762, 730, -638,
                -692, -789, -209, -446, -312, -846, -813, -291, -671, 489, 455, 757, -217, -345,
                -300, 291, -290, 565, 233, 691, 46, 905, 879, 729, 840, 416, 983, 767, -334, -605,
                -903, -280, -99, 832, -764, -587, 223, -758, -616, 925, -751, -320, 115, 612, -752,
                509, -68, 617, -511, -26, -474, 80, 282, -799, -652, 36, 101, 592, 954, -205, 723,
                326, 744, 556, -789, 995, 414, 464, 593, -876, -731, -36, 134, -407, 54, 331, 168,
                95, 162, -650, 697, 821, -657, -144, -32, 571, -322, 224, -277, -989, 595, 209,
                613, -636, -883, -688, -805, 792, 287, -242, -306, -481, -164, 315, 557, 855, 942,
                169, -487, 658, 719, -492, 146, -173, -464, -274, 990, 727, -720, -954, 393, -908,
                631, 978, -893, -812, -648, -366, 352, 367, -266, -240, 92, 262, -316, 493, 766,
                -278, 279, 621, 829, 426, 331, 323, 449, -483, 465, 406, 885, -101, -772, -493,
                -723, 492, 914, 804, 909, -127, -415, 294, 87, -335, 457, 723, 389, -893, 524, 339,
                723, -578, -460, -572, -703, 264, 619, 410, -729, 983, 540, 955, -974, 705, 148,
                650, 811, 883, 280, 998, 873, -161, 600, 938, 7, 746, 31, -312, 890, -291, 776,
                -643, 793, 295, 123, -532, -602, 940, -806, 887, 14, 909, 121, 818, -434, 553, 152,
                -86, -744, -900, -149, -640, 778, 613, 41, 475, 393, 494, -530, -797, 707, -946,
                -871, 505, -801, -99, 53, -485, 94, -79, -948, 394, -111, 420, -87, -679, 860, -75,
                853, 596, -795, -55, -950, -587, 665, -89, 279, -482, 880, 476, 125, -740, 918,
                816, -630, -332, -64, -713, 106, -852, 163, -32, 693, 20, -1000, -253, 367, 433,
                466, -806, -186, -956, 832, -876, 449, 385, 283, -96, 522, 344, 111, -970, 353,
                791, -669, -495, 711, 760, -294, 721, 863, 276, -775, 123, 683, -216, -567, -997,
                348, 301, 153, 530, 39, -475, 54, -398, 904, -683, -305, 146, 895, 176, -126, 723,
                -939, 979, -957, -497, -614, -397, -496, 113, -285, 169, 287, 704, -403, -458,
                -108, 502, 753, 239, 146, -995, -571, -571, -382, -676, -14, -139, 24, 194, 759,
                499, 968, -917, 768, -505, -306, -588, -352, 837, 399, 359, -830, 183, 969, -395,
                -436, 494, -666, -551, 812, 250, 620, 953, 999, 889, -168, -956, 769, -29, -798,
                -973, 750, -266, -73, 469, 129, -285, 770, -262, -776, 894, -379, 749, -400, -546,
                399, 473, -232, -556, -881, 408, -823, 551, 824, 533, -363, 108, -936, 733, -376,
                865, 626, 956, 220, 925, 603, -786, -232, 81, -640, 936, -889, 734, -317, 685, 437,
                -379, 835, -457, -76, -716, -162, -809, -590, -977, 969, -270, 756, -382, -772, 4,
                342, 943, -869, -116, -34, 163, -290, -950, -353, -295, 454, -1, -226, -203, -63,
                -182, 992, 536, -340, 763, 107, 288, 135, 245, -849, -973, 309, 81, -846, -249,
                -778, 630, -225, -728, -341, -545, 581, -784, 235, -92, -752, -775, 417, -216, 506,
                397, 255, -365, 829, 834, -643, -881, 831, -903, 194, -120, 381, -824, -137, 394,
                843, 388, -677, 134, -538, -824, 117, 472, -956, -550, 880, -340, -702, -174, -574,
                -871, 236, 805, -271, -652, 127, -127, 161, 118, 725, 473, -492, 761, 969, 945,
                894, 234, 453, -23, -100, 481, 242, 838, -463, 109, 576, -717, -293, -692, -272,
                -110, 874, 397, 607, -695, -129, 968, -679, -493, -958, 187, -444, 77, 915, 860,
                -387, 876, -511, 846
            ]),
            79
        );
    }
}
